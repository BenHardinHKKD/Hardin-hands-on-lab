steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-467dda20-28e1-4735-b364-8746bcd74572:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 6cd8e818-41d3-4769-b097-eb9dc434d0ee
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b74dca46-eaa3-4d3b-b02e-884a3dd9432d
                    stepCounter: 8bbe9e6b-41b6-40a9-8656-9afca51b0402
                transform: ""
          - columnReference:
              columnCounter: 881e3487-e72c-42e4-964a-05fb889e951c
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b573f946-6f52-40d9-81cb-ead41c85cb80
                    stepCounter: 91ce4a64-e55b-4df1-a78d-077c10d634a6
                transform: ""
          - columnReference:
              columnCounter: f42f25d1-ec8a-4f82-afad-0725bf637e76
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e2051577-4dd5-46c2-8422-5d173e713060
                    stepCounter: 6dd434b0-620f-4351-bfd3-64b33857041c
                transform: ""
          - columnReference:
              columnCounter: 4a43435a-7612-4975-bc08-89890c46893b
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4a4d31b9-5fbf-4849-9de7-cd8bbd05c44c
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 1d14dd5c-26aa-4f02-a96f-c896af4d27fe
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 18135e6a-3d68-4742-8152-011643113478
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 734e47a9-6486-4733-b43d-3e906d859182
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3478104a-b05f-47cc-b847-d2a62d81238f
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 65ef1679-7225-41ce-af19-fa910c50f719
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0547043d-e44c-47f3-a6df-8de7179a130e
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 730d05d5-68b8-4dd0-b8ae-f9a35a143493
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0af17462-3f5e-4374-8cce-76f08d275af8
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 918cff6f-6593-45b0-9feb-87875df1f682
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 849723d1-2288-46d6-b259-4d39bd202f9b
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 3b502484-591e-4ad8-9442-1bb6d7af4736
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fc7ea135-63d4-4866-b824-24bd117a20f3
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: aee128d3-4684-4785-a2f3-4de3f5e56ca3
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4eacf64d-5bb0-4dc2-91e6-14de8f258fd1
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 77b00b6a-7b37-4571-86cf-41072c02e3f4
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ead82154-d193-43ec-8fa9-3af3d340aa82
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: ed4a936c-d53f-456d-be16-d549db1e4f7d
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: deb03473-e275-4863-8559-147b9b1b7156
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 62efafa2-8407-406e-8a2d-e1eb8409a544
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ab91b182-155f-42b6-9ca5-78a04278c7fa
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 66199b11-e393-448c-b3b9-b05fe1137ae2
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9bb0e459-c4fc-4501-bf56-0a1fc503972e
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 54e5b114-057a-42b8-89ab-10482a6fc528
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 34654917-24e9-45ce-a52d-dd5bd2b0d57f
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: d0384f01-f8e1-4230-9018-aba4a1e5f7fd
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ec0c7a28-cf75-4f42-a2fa-eee22928bee8
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 8deec6c9-d2b5-4929-a95d-d3e9f9448680
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ed056731-ddc2-4414-a6c5-55ffc26e60eb
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 649dc44e-52c7-48c5-ad70-58ef4a2677f8
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a66a4f42-0639-4842-92b1-699df792849e
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 92f2849a-1fce-4d23-bf0b-4e5ca73a6d38
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8b41f45f-9031-4dfa-ab25-a0f10704fc3c
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 69bf0c1c-dbc0-40bb-b4e1-3a7f6aec39ac
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f1dc63a3-eb32-4d28-9d2b-37232a9767cb
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 8dd17ef0-8e35-472b-a54f-0a425e3d9260
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 50a77bc8-e212-4638-8b34-6acfc31a2d15
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 5757818b-a410-4438-818a-b30e4eaf5f46
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ff6575c1-9d7b-42eb-abaa-51c4d5d2341d
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 60dff312-076e-46de-bbe9-2caf86534ae3
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: aacb9bb0-ea39-483a-8940-f3c936773ee2
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 5300fda3-a9fe-48cc-8386-09e385dab512
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 042de426-e6f1-4b44-9a8b-61f6cfa5bc9a
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: dd7f5e20-ab6e-4feb-8a1e-f2779a803688
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bae0fad5-141d-489c-bece-629d0369ca7c
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 361ec2ae-99fb-4bb3-9ec5-e0a9a698e9f9
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2d62ad79-196f-40f9-bd7d-f3a9404483f8
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 8c49a67c-4d17-4f94-acb7-7a85ed0a14df
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ae026d89-6064-48b3-8ad8-82382d9aa428
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: 97928fc9-2c4c-48fb-acc3-e6ca5cfede2a
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b1d2540f-9365-4b0b-aafe-cba100eb8f9c
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - columnReference:
              columnCounter: c91cb8a2-1f56-48f2-a53b-09c67750c885
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dac82936-2b10-4e92-a8dd-fcf435e0cdb5
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: e869606f-884d-4c13-be85-4317ca0e4d7e
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8e9fac9c-07f5-4428-b64e-7648e0c89625
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6d067ba0-250b-423f-800c-ea5a0d864543
              stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 069296dd-467d-47a0-909d-f7e041995e54
                    stepCounter: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 8bbe9e6b-41b6-40a9-8656-9afca51b0402
              DIM_PART: 91ce4a64-e55b-4df1-a78d-077c10d634a6
              DIM_SUPPLIER: 6dd434b0-620f-4351-bfd3-64b33857041c
              STG_LINEITEM_ORDERS: 2f300224-3d42-4f0a-8aa4-b5157cb14ed6
              STG_PARTSUPP: 1e0a9c09-d6df-4e00-954d-2332ff1fa85c
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"

                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"

                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"

                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"

                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */

                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"

                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"

                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"

                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"

                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"

                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND

                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 467dda20-28e1-4735-b364-8746bcd74572
